r40257 branches/andy/9954c