r40776 branches/andy/13399