r40820 branches/andy/13399