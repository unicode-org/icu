<!--
* Â© 2017 and later: Unicode, Inc. and others.
* License & terms of use: http://www.unicode.org/copyright.html#License
-->
<!--
/*
*******************************************************************************
* Copyright (C) 2006-2013, International Business Machines Corporation and    *
* others. All Rights Reserved.                                                *
*******************************************************************************
* This is the ant build file for ICU tools.
*/
-->
<project name="release-tools" default="tools" basedir="." >
    <target name="init">
        <tstamp/>
    	<property name="tool.jar" value="target/icu4c-api-report-1.0.0-jar-with-dependencies.jar"/>
        <property name="src.dir" value="src"/>
        <property name="lib.dir" value="lib"/>
        <property name="xslt.dir" value="xslt"/>
        <property file="api-report.properties" />

        <echo message="java home: ${java.home}"/>
        <echo message="java version: ${java.version}"/>
        <echo message="java vendor: ${java.vm.vendor}"/>
        <echo message="ant java version: ${ant.java.version}"/>
        <echo message="${ant.version}"/>
        <echo message="${basedir}"/>
    </target>

    <target name="tools"  depends="init" description="compile release tools">
        <!-- call maven to do this -->
        <exec dir="." executable="cmd" osfamily="windows">
            <arg line="mvn package"/>
        </exec>
        <exec dir="." executable="sh" osfamily="unix">
            <arg line="mvn package"/>
        </exec>
    </target>

    <target name="clean" depends="init" description="remove all build targets">
        <exec dir="." executable="cmd" osfamily="windows">
            <arg line="mvn clean"/>
        </exec>
        <exec dir="." executable="sh" osfamily="unix">
            <arg line="mvn clean"/>
        </exec>
    </target>

    <target name="apireport" depends="tools">
        <java jar="${tool.jar}" fork="yes" failonerror="true">

<!--
            <arg value = "-DELETEME-newver"/>
            <arg value = "4.6"/>
-->

            <arg value = "--olddir"/>
            <arg value = "${olddir}"/>

<!--
	!! Only need these if you must override. Remove the DELETEME
            <arg value = "-DELETEME-newver"/>
            <arg value = "${newver}"/>
-->

            <arg value = "--newdir"/>
            <arg value = "${newdir}"/>

            <arg value = "--cppxslt"/>
            <arg value = "dumpAllCppFunc.xslt"/>

            <arg value = "--cxslt"/>
            <arg value = "dumpAllCFunc.xslt"/>

            <arg value = "--reportxslt"/>
            <arg value = "genReport.xslt"/>

            <arg value = "--resultfile"/>
            <arg value = "${basedir}/APIChangeReport.html"/>

        </java>
    </target>
    <target name="apireport_xml" depends="tools">
        <java jar="${tool.jar}" fork="yes" failonerror="true">

<!--
            <arg value = "-DELETEME-newver"/>
            <arg value = "4.4.1"/>

-->

<!--
            <arg value = "-DELETEME-newver"/>
            <arg value = "4.6"/>
-->

            <arg value = "--olddir"/>
            <arg value = "${olddir}"/>

<!--
	!! Only need these if you must override. Remove the DELETEME
            <arg value = "-DELETEME-newver"/>
            <arg value = "${newver}"/>
-->

            <arg value = "--newdir"/>
            <arg value = "${newdir}"/>

            <arg value = "--cppxslt"/>
            <arg value = "dumpAllCppFunc_xml.xslt"/>

            <arg value = "--cxslt"/>
            <arg value = "dumpAllCFunc_xml.xslt"/>

            <arg value = "--reportxslt"/>
            <arg value = "genreport_xml.xslt"/>

            <arg value = "--resultfile"/>
            <arg value = "${basedir}/APIChangeReport.xml"/>

        </java>
    </target>
</project>
