r40291 branches/mingzha/C4251_warning_cleanup