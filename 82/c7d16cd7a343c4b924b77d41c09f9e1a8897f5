r40331 branches/andy/9954d