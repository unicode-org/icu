r40330 branches/andy/9954d