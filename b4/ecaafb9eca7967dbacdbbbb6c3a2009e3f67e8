r40290 branches/mingzha/c4251_warning_fix