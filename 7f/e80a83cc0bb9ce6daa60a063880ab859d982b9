r40377 branches/andy/9954d